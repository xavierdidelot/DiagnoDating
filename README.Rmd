---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/"
)
set.seed(0)
```

# Introduction

The aim of this package is to check if a dated phylogeny is valid. 
Many tools exist to produce dated phylogenies, but there are several factors that can invalidate the results.
This includes the confounding effect that population structure can have on dating.
But it also includes incorrect assumptions made when running a dating analysis, for example using an inappropriate clock model. 

## Installation

You can install ValidateDating from github with:

```{r gh-installation, eval = FALSE}
devtools::install_github("xavierdidelot/ValidateDating")
```

The package can then be loaded using:
```{r}
library(ValidateDating,quietly=T)
```

## Example

This is a basic example of usage. First we generate a dated tree with 10 samples between 2000 and 2020:
```{r}
dates=runif(10,2000,2020)
dt=simcoaltree(dates)
plot(dt)
axisPhylo(backward=F)
```

Next we generate a phylogenetic tree using a Poisson(10) mutation model, 
and perform a root-to-tip analysis:
```{r}
phy=simobsphy(dt,mu=10,model='poisson')
r=roottotip(phy,dates)
```

We can run the dating analysis on this phylogeny as follows:
```{r}
r=runDating(phy,dates)
plot(r)
```

We can see how this dated phylogeny fits the data:
```{r}
plotProbBranches(r)
plotResid(r)
print(testResid(r))
```

## More information and getting help

For more detailed examples of how to use ValidateDating, see the vignettes [here](https://github.com/xavierdidelot/ValidateDating/tree/master/vignettes).
See also the help included in the package using the R command
`help(package='ValidateDating')`. 

If you have any problem or question please create an issue [here](https://github.com/xavierdidelot/ValidateDating/issues) 
or get in touch by emailing `xavier.didelot@gmail.com`
