<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using DiagnoDating on your own data • DiagnoDating</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using DiagnoDating on your own data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DiagnoDating</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/HBV.html">Analysis of HBV data</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Analysis of simulated data</a></li>
    <li><a class="dropdown-item" href="../articles/yourData.html">Using DiagnoDating on your own data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xavierdidelot/DiagnoDating/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using DiagnoDating on your own data</h1>
                        <h4 data-toc-skip class="author">Xavier
Didelot</h4>
            
            <h4 data-toc-skip class="date">2026-01-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xavierdidelot/DiagnoDating/blob/HEAD/vignettes/yourData.Rmd" class="external-link"><code>vignettes/yourData.Rmd</code></a></small>
      <div class="d-none name"><code>yourData.Rmd</code></div>
    </div>

    
    
<p>In this vignette we describe how you can use DiagnoDating on your own
data.</p>
<div class="section level2">
<h2 id="first-input-phylogenetic-tree">First input: phylogenetic tree<a class="anchor" aria-label="anchor" href="#first-input-phylogenetic-tree"></a>
</h2>
<p>The first required input (let’s call it <code>t</code>) is a
phylogenetic tree of the class <code>phylo</code> from the
<code>ape</code> package, which can be loaded from a Newick or Nexus
file using respectively the following commands from the <code>ape</code>
package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="va">t</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="st">'filename.nwk'</span><span class="op">)</span></span>
<span><span class="va">t</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.nexus.html" class="external-link">read.nexus</a></span><span class="op">(</span><span class="st">'filename.nex'</span><span class="op">)</span></span></code></pre></div>
<p>This tree should have branch lengths measured in units of
substitutions. In other words, the branch lengths should not be measured
in substitutions per site. If you are not sure whether the branch
lengths are measured correctly or not, try to compute
<code>sum(t$edge.length)</code>. This should be the total number of
substitutions throughout the tree, so if you get a value below one or
even only a bit above one, your branch lengths are probably not in the
correct unit.</p>
<p>If the branch branch lengths are measured per site, you will need to
rescale them using the command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span><span class="op">$</span><span class="va">edge.length</span><span class="op">=</span><span class="va">t</span><span class="op">$</span><span class="va">edge.length</span><span class="op">*</span><span class="va">L</span></span></code></pre></div>
<p>where <code>L</code> is the number of sites which were used to build
this tree.</p>
</div>
<div class="section level2">
<h2 id="second-input-isolation-dates">Second input: isolation dates<a class="anchor" aria-label="anchor" href="#second-input-isolation-dates"></a>
</h2>
<p>The second required input (let’s call it <code>d</code>) is the dates
at which the isolates were sampled. Dates need to be expressed in
decimal years, for example <code>2015.5</code> means 1st July 2015. If
needed, you can convert into decimal years from other date formats using
the <code>decimal_date</code> function of the <code>lubridate</code>
package. This input can be simply a vector of decimal dates, in which
case the order needs to be the same as the order of the tree tips in
<code>t$tip.label</code>. For example, if <code>t$tip.label</code> is
<code>(A,B,C)</code> then <code>d=c(2010,2011,2012)</code> indicates
that <code>A</code> was isolated in 2010, B in 2011 and C in 2012.</p>
<p>Alternatively, the vector <code>d</code> does not have to be ordered
if <code>names(d)</code> corresponds to the tip names. For example,
d=c(2011,2010,2012)<code>with names(d)=c('B','A','C')</code> would have
the same meaning as in the previous example.</p>
<p>If some isolation dates are unknown, this can be indicated using
<code>NA</code> in the vector, in which case the date is considered
unknown but within the range of known dates, ie with the range return by
the command <code>range(d,na.rm=T)</code>.</p>
</div>
<div class="section level2">
<h2 id="running-a-dating-analysis">Running a dating analysis<a class="anchor" aria-label="anchor" href="#running-a-dating-analysis"></a>
</h2>
<p>Once the two inputs <code>t</code> and <code>d</code> described above
are in the correct format, you are ready to run a dating analysis using
the main command:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xavierdidelot.github.io/DiagnoDating/">DiagnoDating</a></span><span class="op">)</span></span>
<span><span class="va">r</span><span class="op">=</span><span class="fu"><a href="../reference/runDating.html">runDating</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">d</span><span class="op">)</span></span></code></pre></div>
<p>Note that there are several optional arguments for this command that
can be useful, to select the dating algorithm to use, the clock model,
whether the tree is rooted or should be estimated, and whether the rate
is known or should be estimated. For more details see
<code><a href="../reference/runDating.html">help(runDating)</a></code></p>
</div>
<div class="section level2">
<h2 id="computing-diagnostics-on-the-dating-analysis">Computing diagnostics on the dating analysis<a class="anchor" aria-label="anchor" href="#computing-diagnostics-on-the-dating-analysis"></a>
</h2>
<p>You can perform a posterior predictive check using the command:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">=</span><span class="fu"><a href="../reference/ppcheck.html">ppcheck</a></span><span class="op">(</span><span class="va">r</span>,showPlot <span class="op">=</span> <span class="cn">T</span>,showProgress <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>You can see the likelihood of each branch using the command:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotLikBranches.html">plotLikBranches</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p>You can compute the residuals as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResid.html">plotResid</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p>You can compute the posterior distribution of residual p-values as
follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">=</span><span class="fu"><a href="../reference/postdistpvals.html">postdistpvals</a></span><span class="op">(</span><span class="va">r</span>,showPlot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xavier Didelot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
