<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of HBV data â€¢ DiagnoDating</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of HBV data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DiagnoDating</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/HBV.html">Analysis of HBV data</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Analysis of simulated data</a></li>
    <li><a class="dropdown-item" href="../articles/yourData.html">Using DiagnoDating on your own data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xavierdidelot/DiagnoDating/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of HBV data</h1>
                        <h4 data-toc-skip class="author">Xavier
Didelot</h4>
            
            <h4 data-toc-skip class="date">2026-01-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xavierdidelot/DiagnoDating/blob/HEAD/vignettes/HBV.Rmd" class="external-link"><code>vignettes/HBV.Rmd</code></a></small>
      <div class="d-none name"><code>HBV.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="loading-the-data">Loading the data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>In this vignette we demonstrate the usage of DiagnoDating on a
dataset of Hepatitis B virus (HBV) published by Zoe Patterson Ross et al
(2018). The data for this example can be loaded using the command
<code>data(HBV)</code>. This will load in your environment the object
<code>phy</code> which is the phylogeny constructed using PhyML. To
perform dating, we also need to know the dates of the samples. This is
stored in labels of the tips of the phylogeny, and can be extracted as
follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xavierdidelot.github.io/DiagnoDating/">DiagnoDating</a></span>,quietly<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HBV</span><span class="op">)</span></span>
<span><span class="va">dates</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*_"</span>,<span class="st">""</span>,<span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span><span class="op">=</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dating-analysis">Dating analysis<a class="anchor" aria-label="anchor" href="#dating-analysis"></a>
</h2>
<p>Let us perform a dating analysis using BactDating and the additive
relaxed clock model (ARC):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span><span class="op">=</span><span class="fu"><a href="../reference/runDating.html">runDating</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/root.html" class="external-link">unroot</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>,<span class="va">dates</span>,model<span class="op">=</span><span class="st">'arc'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Result from BactDating, model arc, clock rate 0.29, relaxation parameter 27.75, root date 1158.83</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="diagnostics-of-the-dating-analysis">Diagnostics of the dating analysis<a class="anchor" aria-label="anchor" href="#diagnostics-of-the-dating-analysis"></a>
</h2>
<p>The posterior predictive check is not satisfied:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ppcheck.html">ppcheck</a></span><span class="op">(</span><span class="va">r</span>,showPlot <span class="op">=</span> <span class="cn">T</span>,showProgress <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="HBV_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span><span class="co">## [1] 0.008</span></span></code></pre>
<p>The residual analysis is also not satisfied:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps</span><span class="op">=</span><span class="fu"><a href="../reference/postdistpvals.html">postdistpvals</a></span><span class="op">(</span><span class="va">r</span>,showPlot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="HBV_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span><span class="co">## The posterior distribution of p-values has median 0.00 and 99.70% of values below 5%</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xavier Didelot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
