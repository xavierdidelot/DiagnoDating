<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DiagnoDating: diagnostics for dated phylogenies in microbial population genetics â€¢ DiagnoDating</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="DiagnoDating: diagnostics for dated phylogenies in microbial population genetics">
<meta name="description" content="DiagnoDating is a R package to diagnose the results of phylogeny dating analysis.">
<meta property="og:description" content="DiagnoDating is a R package to diagnose the results of phylogeny dating analysis.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">DiagnoDating</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/HBV.html">Analysis of HBV data</a></li>
    <li><a class="dropdown-item" href="articles/simulation.html">Analysis of simulated data</a></li>
    <li><a class="dropdown-item" href="articles/yourData.html">Using DiagnoDating on your own data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xavierdidelot/DiagnoDating/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1></div>
<p>The aim of this package is to diagnose the results of phylogeny dating analysis. Many tools exist to produce dated phylogenies, but there are several factors that can invalidate the results. This includes the confounding effect that population structure can have on dating. But it also includes incorrect assumptions made when running a dating analysis, for example using an inappropriate clock model, not accounting for recombination, etc.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install DiagnoDating from github with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"xavierdidelot/DiagnoDating"</span><span class="op">)</span></span></code></pre></div>
<p>The package can then be loaded using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xavierdidelot.github.io/DiagnoDating/">DiagnoDating</a></span>,quietly<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example of usage. First we generate a dated tree with 10 samples between 2000 and 2020:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">2000</span>,<span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BactDating/man/simcoaltree.html" class="external-link">simcoaltree</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span>backward<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png"><!-- --></p>
<p>Next we generate a phylogenetic tree using a Poisson(10) mutation model, and perform a root-to-tip analysis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phy</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BactDating/man/simobsphy.html" class="external-link">simobsphy</a></span><span class="op">(</span><span class="va">dt</span>,mu<span class="op">=</span><span class="fl">10</span>,model<span class="op">=</span><span class="st">'poisson'</span><span class="op">)</span></span>
<span><span class="va">r</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BactDating/man/roottotip.html" class="external-link">roottotip</a></span><span class="op">(</span><span class="va">phy</span>,<span class="va">dates</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-4-1.png"><!-- --></p>
<p>We can run the dating analysis on this phylogeny as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span><span class="op">=</span><span class="fu"><a href="reference/runDating.html">runDating</a></span><span class="op">(</span><span class="va">phy</span>,<span class="va">dates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --></p>
<p>We can perform a posterior predictive check:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">=</span><span class="fu"><a href="reference/ppcheck.html">ppcheck</a></span><span class="op">(</span><span class="va">r</span>,showPlot <span class="op">=</span> <span class="cn">T</span>,showProgress <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-1.png"><!-- --></p>
<p>We can see the likelihood of each branch:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotLikBranches.html">plotLikBranches</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
<p>We can compute the residuals:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotResid.html">plotResid</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-8-1.png"><!-- --></p>
<p>We can compute the posterior distribution of residual p-values:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">=</span><span class="fu"><a href="reference/postdistpvals.html">postdistpvals</a></span><span class="op">(</span><span class="va">r</span>,showPlot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-9-1.png"><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#&gt; The posterior distribution of p-values has median 0.58 and 4.40% of values below 5%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="more-information-and-getting-help">More information and getting help<a class="anchor" aria-label="anchor" href="#more-information-and-getting-help"></a>
</h2>
<p>For more detailed examples of how to use DiagnoDating, see the vignettes <a href="https://xavierdidelot.github.io/DiagnoDating/">here</a>. See also the help included in the package using the R command <code><a href="https://xavierdidelot.github.io/DiagnoDating/reference">help(package='DiagnoDating')</a></code>.</p>
<p>If you have any problem or question please create an issue <a href="https://github.com/xavierdidelot/DiagnoDating/issues" class="external-link">here</a> or get in touch by emailing <code>xavier.didelot@gmail.com</code></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/xavierdidelot/DiagnoDating/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/xavierdidelot/DiagnoDating/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing DiagnoDating</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Xavier Didelot <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xavier Didelot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
